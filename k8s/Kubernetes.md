# Kubernetes

1 什莫是 kankio

通常，标准 Dockerfile 的生成需要与 Docker 后台进程交互访问，也就是需要本机 root 权限。如果是在 Docker 后台进程无法暴露的场景下，生成容器镜像就变得很困难。

kaniko 是 Google 开源的一个工具，旨在帮助开发人员从容器或 Kubernetes 集群内的 Dockerfile 构建容器镜像。

2外挂配置管理—ConfigMap 

为在实际应用的过程中，我们经常会需要传一些配置给我们的应用，比如配置文件变更啊、用户名密码啊等等之类的。可能这个时候就会有童鞋说了我们有好多种方案可以实现啊  :

1.我们可以直接在打包镜像的时候写在应用配置文件里面。

2.我们可以在配置文件里面通过env环境变量传入。

3.我们可以在应用启动的时候去数据库或者某个特定的地方拿

确实可以实现，但每个方案的弊端也显而易见，比如：

1.这种方式的坏处显而易见而且非常明显，几乎是绑死了配置，不便于后续操作。

2.这样的话我们要修改env就必须去修改yaml文件，而且需要重启所有的Container才行。

3.第三个方案实现起来麻烦，另外如果配置的地方变了怎么办？这个跟第一种方式有点类似，太过于锁死。

如果说我的一个配置，是要多个应用一起使用的，以上除了第三种方案，都没办法进行配置的共享，就是说我如果要改配置的话，那得一个一个手动改。假如我们有100个应用，就得改100份配置，以此类推……



ConfigMap是存储通用的配置变量的，类似于配置文件，使用户可以将分布式系统中用于不同模块的环境变量统一到一个对象中管理；而它与配置文件的区别在于它是存在集群的“环境”中的，并且支持K8S集群中所有通用的操作调用方式。而Secret呢就是存储一些比较敏感的信息，比如：密码、密钥之类的信息。



查看日志   kubectl  logs 镜像name 



webhook 和controller 区别 

1. 用户创建一个自定义资源 (CRD)；
2. apiserver 根据自己注册的一个 pass 列表，把该 CRD 的请求转发给 webhook；
3. webhook 一般会完成该 CRD 的缺省值设定和参数检验。webhook 处理完之后，相应的 CR 会被写入数据库，返回给用户；
4. 与此同时，controller 会在后台监测该自定义资源，按照业务逻辑，处理与该自定义资源相关联的特殊操作；
5. 上述处理一般会引起集群内的状态变化，controller 会监测这些关联的变化，把这些变化记录到 CRD 的状态中。